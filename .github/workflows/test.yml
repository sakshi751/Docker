name: Extract JSON Details

on:
  push:
    branches:
      - main

jobs:
  extractDetails:
    runs-on: ubuntu-latest

    steps:
      - name: Access JSON data
        id: access
        run: |
          # Set the JSON data as a string
          echo '{"id": "12345", "name": "example", "description": "This is an example"}' >> json_data.json

      - name: Install Python
        run: |
          # Install Python
          sudo apt-get update
          sudo apt-get install -y python3

      - name: Extract Details
        id: extract
        run: |
          # Parse the JSON data and extract details based on input value using Python
          json_data=$(cat json_data.json)
          value_needed="example"  # Update this with the value you want to search for

          # Extract details using Python
          details=$(python3 -c "
import json

json_data = '''$json_data'''
value_needed = '''$value_needed'''

data = json.loads(json_data)
details = [item['description'] for item in data if item['name'] == value_needed]

print('Extracted Details:', details[0] if details else None)
          ")

          # Store the extracted details as an output
          echo "::set-output name=details::$details"

      - name: Use the extracted details
        run: |
          # Access the extracted details
          extracted_details="${{ steps.extract.outputs.details }}"
          echo "Extracted Details: $extracted_details"
